<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head(${producto.nombre})}"></head>
<body>
<div th:replace="~{layout :: header}"></div>

<main class="container">
    <div class="product-detail-grid">
        <div class="product-detail-image">
            <img th:src="${producto.imagenUrl}" onerror="this.onerror=null;this.src='https://placehold.co/800x600/e2e8f0/334155?text=Producto';" alt="Imagen del producto">
        </div>
        <div class="product-detail-info">
            <h1 th:text="${producto.nombre}">Nombre del Producto</h1>
            <p class="detail-price" th:text="'S/ ' + ${#numbers.formatDecimal(producto.precio, 1, 2)}">S/ 99.90</p>

            <!-- --- LÓGICA DE STOCK CORREGIDA --- -->
            <div th:if="${producto.stock > 0}">
                <p class="detail-stock available" th:text="'Stock disponible: ' + ${producto.stock}"></p>
            </div>
            <div th:if="${producto.stock == 0}">
                <p class="detail-stock out-of-stock">Producto Agotado</p>
            </div>
            <!-- --- FIN LÓGICA --- -->

            <p class="detail-description" th:text="${producto.descripcion}">Descripción larga y detallada del producto.</p>

            <div th:if="${producto.stock > 0}">
                <a th:href="@{/carrito/agregar/{id}(id=${producto.id})}" class="btn btn-primary" style="margin-top: 1.5rem;">Añadir al carrito</a>
            </div>
            <div th:if="${producto.stock == 0}">
                <button class="btn btn-disabled" style="margin-top: 1.5rem;" disabled>Agotado</button>
            </div>

            <div class="social-share">
                <span>Compartir:</span>
                <a th:href="'https://www.facebook.com/sharer/sharer.php?u=http://localhost:8080/productos/' + ${producto.id}" target="_blank" class="social-icon facebook">Facebook</a>
                <a th:href="'https://twitter.com/intent/tweet?url=http://localhost:8080/productos/' + ${producto.id} + '&text=¡Mira este increíble producto!'" target="_blank" class="social-icon twitter">Twitter</a>
                <a th:href="'https://api.whatsapp.com/send?text=¡Mira este increíble producto! http://localhost:8080/productos/' + ${producto.id}" target="_blank" class="social-icon whatsapp">WhatsApp</a>
            </div>
        </div>
    </div>
</main>

<div th:replace="~{layout :: footer}"></div>
</body>
</html>